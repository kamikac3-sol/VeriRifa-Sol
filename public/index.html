<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VeriRifa-Sol - Sorteos Verificados en Solana</title>
    
    <!-- Cargar Solana Web3.js primero -->
    <script src="https://unpkg.com/@solana/web3.js@latest/lib/index.iife.js"></script>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-analytics-compat.js"></script>

    <style>
        /* TODOS LOS ESTILOS ORIGINALES AQU√ç - NO LOS CAMBIES */
        :root {
            --primary: #9945FF;
            --secondary: #14F195;
            --dark: #121212;
            --light: #f8f9fa;
            --gray: #6c757d;
            --success: #28a745;
            --danger: #dc3545;
            --warning: #ffc107;
            --info: #17a2b8;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--dark);
            color: var(--light);
            line-height: 1.6;
            overflow-x: hidden;
            padding-top: 80px;
        }

        .container {
            width: 95%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 10px;
        }

        /* ... (MANT√âN TODOS TUS ESTILOS ORIGINALES AQU√ç) ... */

    </style>
</head>
<body>
    <!-- ESTRUCTURA HTML COMPLETA - NO LA CAMBIES -->
    <div class="user-alert" id="user-alert">
        <div class="alert-content">
            <div class="alert-icon" id="alert-icon">‚ö†Ô∏è</div>
            <div class="alert-message" id="alert-message">Mensaje de alerta</div>
            <button class="close-alert" id="close-alert">&times;</button>
        </div>
    </div>

    <!-- Wallet Modal -->
    <div class="wallet-modal" id="wallet-modal">
        <!-- ... (todo el contenido del modal wallet) ... -->
    </div>

    <!-- Modal para Reclamar Premio -->
    <div class="claim-prize-modal" id="claim-prize-modal">
        <!-- ... (todo el contenido del modal claim) ... -->
    </div>

    <!-- Header -->
    <header>
        <!-- ... (todo el contenido del header) ... -->
    </header>

    <!-- Hero Section -->
    <section class="hero" id="inicio">
        <!-- ... (todo el contenido del hero) ... -->
    </section>

    <!-- Features -->
    <section class="features" id="como-funciona">
        <!-- ... (todo el contenido de features) ... -->
    </section>

    <!-- Admin Panel -->
    <section class="admin-panel" id="admin-panel">
        <!-- ... (todo el contenido del admin panel) ... -->
    </section>

    <!-- Raffles -->
    <section class="raffles" id="sorteos">
        <!-- ... (todo el contenido de raffles) ... -->
    </section>

    <!-- Footer -->
    <footer>
        <!-- ... (todo el contenido del footer) ... -->
    </footer>

    <!-- Number Selection Modal -->
    <div class="modal" id="number-selection-modal">
        <!-- ... (todo el contenido del modal de n√∫meros) ... -->
    </div>

<script>
// =============================================
// CONFIGURACI√ìN FIREBASE - VERIFICADA
// =============================================
console.log('üöÄ Inicializando VeriRifa-Sol...');

// Configuraci√≥n de Firebase
const FIREBASE_CONFIG = {
    apiKey: "AIzaSyBFeUIpZ4SvDJH60WJyuPB9Ud2JJSbjN7Q",
    authDomain: "veririfa-sol.firebaseapp.com",
    projectId: "veririfa-sol",
    storageBucket: "veririfa-sol.firebasestorage.app",
    messagingSenderId: "398195570983",
    appId: "1:398195570983:web:f415c5e20213ccca2fd102",
    measurementId: "G-1BJXVTRG15"
};

// Inicializar Firebase
let firebaseApp;
let db;
let analytics;

try {
    firebaseApp = firebase.initializeApp(FIREBASE_CONFIG);
    db = firebase.firestore();
    analytics = firebase.analytics();
    console.log('‚úÖ Firebase inicializado correctamente');
} catch (error) {
    console.error('‚ùå Error inicializando Firebase:', error);
}

// =============================================
// CONEXI√ìN REAL CON SOLANA TESTNET
// =============================================
const network = 'testnet';
const connection = new solanaWeb3.Connection(
    solanaWeb3.clusterApiUrl(network),
    'confirmed'
);

// WALLET VERIFICADA DEL ADMINISTRADOR
const ADMIN_WALLET_ADDRESS = '3Yekte2UrR2rKFBfm3q6D2DyinZKN58svqJvQF87RX3o';
const ADMIN_WALLET_PUBKEY = new solanaWeb3.PublicKey(ADMIN_WALLET_ADDRESS);

// =============================================
// ESTADO GLOBAL DE LA APLICACI√ìN
// =============================================
let isConnected = false;
let isAdmin = false;
let currentRaffle = null;
let selectedNumbers = [];
let currentPage = 1;
const numbersPerPage = 100;

let currentWallet = {
    publicKey: null,
    provider: null,
    balance: 0
};

let raffles = [];
let winners = [];
let currentPrizeToClaim = null;

// =============================================
// FUNCIONES PRINCIPALES CORREGIDAS
// =============================================

// FUNCI√ìN MEJORADA: renderRaffles
function renderRaffles() {
    console.log('üîÑ Renderizando sorteos...', raffles.length);
    const container = document.getElementById('raffles-container');
    if (!container) {
        console.error('‚ùå No se encontr√≥ el contenedor de sorteos');
        return;
    }

    container.innerHTML = '';

    const activeRaffles = raffles.filter(raffle => !raffle.completed);
    
    if (activeRaffles.length === 0) {
        container.innerHTML = `
            <div style="text-align: center; color: var(--gray); padding: 3rem;">
                <h3>üìù No hay sorteos activos</h3>
                <p>Conecta tu wallet verificada para crear el primer sorteo</p>
            </div>
        `;
        return;
    }

    activeRaffles.forEach(raffle => {
        const raffleCard = document.createElement('div');
        raffleCard.className = 'raffle-card';
        
        const progress = raffle.soldNumbers ? raffle.soldNumbers.length : 0;
        const total = raffle.totalNumbers || 0;
        const progressPercent = total > 0 ? (progress / total) * 100 : 0;
        
        const isUserWinner = raffle.winner && currentWallet.publicKey && 
                            raffle.winner.wallet === currentWallet.publicKey.toString();
        
        const allNumbersSold = progress >= total;
        
        let actionButton = '';
        
        if (raffle.winner) {
            if (isUserWinner) {
                if (raffle.prizeClaimed) {
                    actionButton = `
                        <button class="btn" style="width: 100%; background: var(--success); cursor: not-allowed;" disabled>
                            ‚úÖ Premio Reclamado
                        </button>
                    `;
                } else {
                    actionButton = `
                        <button class="btn btn-success claim-prize-btn" data-raffle="${raffle.id}" style="width: 100%;">
                            üéâ Reclamar Premio
                        </button>
                    `;
                }
            } else {
                actionButton = `
                    <button class="btn" style="width: 100%; background: var(--gray); cursor: not-allowed;" disabled>
                        ‚ùå No Ganaste
                    </button>
                `;
            }
        } else if (raffle.isSelectingWinner) {
            actionButton = `
                <button class="btn" style="width: 100%; background: var(--warning); cursor: not-allowed;" disabled>
                    ‚è≥ Seleccionando Ganador...
                </button>
            `;
        } else {
            if (isAdmin) {
                if (allNumbersSold) {
                    actionButton = `
                        <button class="btn btn-warning select-winner-btn" data-raffle="${raffle.id}" style="width: 100%;">
                            üé∞ Seleccionar Ganador
                        </button>
                    `;
                } else {
                    const remainingNumbers = total - progress;
                    actionButton = `
                        <button class="btn btn-disabled" style="width: 100%;" disabled>
                            ‚è≥ Esperando venta (${remainingNumbers} n√∫meros restantes)
                        </button>
                    `;
                }
            } else {
                if (allNumbersSold) {
                    actionButton = `
                        <button class="btn btn-disabled" style="width: 100%;" disabled>
                            üîí Todos los n√∫meros vendidos
                        </button>
                    `;
                } else {
                    actionButton = `
                        <button class="btn participate-btn" data-raffle="${raffle.id}" style="width: 100%;">
                            üé´ Participar (${raffle.price} SOL)
                        </button>
                    `;
                }
            }
        }

        raffleCard.innerHTML = `
            <div class="raffle-image">
                ${raffle.image && raffle.image.startsWith('http') ? 
                    `<img src="${raffle.image}" alt="${raffle.name}" onerror="this.parentElement.innerHTML='${raffle.image.includes('üéÆ') ? 'üéÆ' : 'üéÅ'}'">` : 
                    `<div style="font-size: 3rem;">${raffle.image || 'üéÅ'}</div>`
                }
            </div>
            <div class="raffle-content">
                <h3 class="raffle-title">${raffle.name}</h3>
                <div class="raffle-price">${raffle.price} SOL por n√∫mero</div>
                <div class="raffle-info">
                    <span>üéØ Premio: ${raffle.prize || raffle.name}</span>
                    <span>üî¢ ${progress}/${total} n√∫meros</span>
                </div>
                <div class="progress-bar">
                    <div class="progress" style="width: ${progressPercent}%"></div>
                </div>
                <div class="raffle-info">
                    <span>üèÜ Ganador: ${raffle.winner ? 'S√≠' : 'No'}</span>
                    <span>${allNumbersSold ? 'üîí Completado' : 'üü¢ Disponible'}</span>
                </div>
                <div>
                    ${actionButton}
                </div>
            </div>
        `;

        container.appendChild(raffleCard);
    });

    // CONFIGURAR EVENT LISTENERS INMEDIATAMENTE
    setTimeout(() => {
        setupRaffleEventListeners();
    }, 100);
}

// FUNCI√ìN MEJORADA: Configurar event listeners
function setupRaffleEventListeners() {
    console.log('üîß Configurando event listeners...');
    
    // Botones de participaci√≥n
    document.querySelectorAll('.participate-btn').forEach(btn => {
        btn.addEventListener('click', function() {
            if (!currentWallet.publicKey) {
                showUserAlert('üîó Conecta tu wallet primero para participar', 'warning');
                document.getElementById('wallet-modal').classList.add('active');
                return;
            }
            const raffleId = this.getAttribute('data-raffle');
            console.log('üé´ Participando en sorteo:', raffleId);
            openNumberSelectionModal(raffleId);
        });
    });

    // Botones de seleccionar ganador
    document.querySelectorAll('.select-winner-btn').forEach(btn => {
        btn.addEventListener('click', function() {
            const raffleId = this.getAttribute('data-raffle');
            console.log('üé∞ Seleccionando ganador para:', raffleId);
            selectWinner(raffleId);
        });
    });

    // Botones de reclamar premio
    document.querySelectorAll('.claim-prize-btn').forEach(btn => {
        btn.addEventListener('click', function() {
            const raffleId = this.getAttribute('data-raffle');
            console.log('üéâ Reclamando premio para:', raffleId);
            openClaimPrizeModal(raffleId);
        });
    });
}

// =============================================
// FUNCIONES FIREBASE CORREGIDAS
// =============================================

async function saveRafflesToFirebase() {
    if (!db) {
        console.error('‚ùå Firebase no disponible');
        return;
    }

    try {
        for (const raffle of raffles) {
            await db.collection('raffles').doc(raffle.id).set({
                ...raffle,
                lastUpdated: firebase.firestore.FieldValue.serverTimestamp()
            });
        }
        console.log('‚úÖ Sorteos guardados en Firebase');
    } catch (error) {
        console.error('‚ùå Error guardando en Firebase:', error);
        showUserAlert('Error guardando datos en la nube', 'error');
    }
}

async function loadRafflesFromFirebase() {
    if (!db) {
        console.error('‚ùå Firebase no disponible');
        raffles = [];
        return;
    }

    try {
        const snapshot = await db.collection('raffles').get();
        
        if (!snapshot.empty) {
            raffles = [];
            snapshot.forEach(doc => {
                const raffleData = doc.data();
                // Asegurar que todos los campos necesarios existan
                if (!raffleData.soldNumbers) raffleData.soldNumbers = [];
                if (!raffleData.numberOwners) raffleData.numberOwners = {};
                if (raffleData.prizeClaimed === undefined) raffleData.prizeClaimed = false;
                if (raffleData.completed === undefined) raffleData.completed = false;
                
                raffles.push(raffleData);
            });
            console.log('‚úÖ Sorteos cargados desde Firebase:', raffles.length);
        } else {
            console.log('üìù No hay sorteos en Firebase, creando ejemplos...');
            await createSampleRaffles();
        }
    } catch (error) {
        console.error('‚ùå Error cargando desde Firebase:', error);
        raffles = [];
    }
}

async function createSampleRaffles() {
    const sampleRaffles = [
        {
            id: 'ps5-verificado-' + Date.now(),
            name: 'PlayStation 5 - Sorteo Verificado',
            description: 'PS5 real en VeriRifa-Sol - Transacciones verificadas',
            price: 0.1,
            image: 'üéÆ',
            totalNumbers: 50,
            soldNumbers: [],
            numberOwners: {},
            prize: 'PlayStation 5 Real',
            status: 'active',
            adminWallet: ADMIN_WALLET_ADDRESS,
            winner: null,
            prizeClaimed: false,
            completed: false,
            createdAt: new Date().toISOString()
        },
        {
            id: 'macbook-verificado-' + Date.now(),
            name: 'MacBook Pro - Verificado',
            description: 'MacBook Pro real - Blockchain verificada de Solana',
            price: 0.2,
            image: 'üíª',
            totalNumbers: 30,
            soldNumbers: [],
            numberOwners: {},
            prize: 'MacBook Pro 14"',
            status: 'active',
            adminWallet: ADMIN_WALLET_ADDRESS,
            winner: null,
            prizeClaimed: false,
            completed: false,
            createdAt: new Date().toISOString()
        }
    ];

    raffles = sampleRaffles;
    await saveRafflesToFirebase();
    console.log('‚úÖ Sorteos de ejemplo creados');
}

// =============================================
// FUNCIONES PARA CREAR SORTEOS - CORREGIDAS
// =============================================

function setupImagePreview() {
    const imageInput = document.getElementById('raffle-image');
    const preview = document.getElementById('image-preview');
    
    if (imageInput && preview) {
        imageInput.addEventListener('input', function() {
            const value = this.value.trim();
            
            if (value.startsWith('http')) {
                preview.innerHTML = `<img src="${value}" alt="Preview" onerror="this.style.display='none'; preview.innerHTML='‚ùå Error cargando imagen'">`;
            } else if (value) {
                preview.innerHTML = `<div class="emoji-preview">${value}</div>`;
            } else {
                preview.innerHTML = '<div class="emoji-preview">üñºÔ∏è</div>';
            }
        });
    }
}

async function createRaffle(e) {
    e.preventDefault();
    console.log('üéØ Creando nuevo sorteo...');
    
    if (!isAdmin) {
        showUserAlert('‚ùå Solo el verificador puede crear sorteos', 'error');
        return;
    }

    const name = document.getElementById('raffle-name').value.trim();
    const description = document.getElementById('raffle-description').value.trim();
    const price = parseFloat(document.getElementById('ticket-price').value);
    const maxNumbers = parseInt(document.getElementById('max-numbers').value);
    const image = document.getElementById('raffle-image').value.trim();

    if (!name || !description || !price || !maxNumbers || !image) {
        showUserAlert('‚ùå Por favor, completa todos los campos', 'error');
        return;
    }

    if (price < 0.01) {
        showUserAlert('‚ùå El precio debe ser al menos 0.01 SOL', 'error');
        return;
    }

    if (maxNumbers < 10) {
        showUserAlert('‚ùå Debe haber al menos 10 n√∫meros', 'error');
        return;
    }

    showUserAlert('‚è≥ Creando sorteo verificado...', 'info');

    try {
        const raffleId = 'raffle-' + Date.now();
        
        const newRaffle = {
            id: raffleId,
            name: name,
            description: description,
            price: price,
            image: image,
            totalNumbers: maxNumbers,
            soldNumbers: [],
            numberOwners: {},
            prize: name.includes('-') ? name.split('-')[0].trim() : name,
            status: 'active',
            adminWallet: ADMIN_WALLET_ADDRESS,
            winner: null,
            prizeClaimed: false,
            completed: false,
            createdAt: new Date().toISOString()
        };

        raffles.push(newRaffle);
        
        // Guardar en Firebase
        await saveRafflesToFirebase();
        
        // Limpiar formulario
        document.getElementById('create-raffle-form').reset();
        document.getElementById('image-preview').innerHTML = '<div class="emoji-preview">üñºÔ∏è</div>';
        
        // Actualizar UI
        renderRaffles();
        
        showUserAlert('‚úÖ Sorteo verificado creado exitosamente!', 'success');

    } catch (error) {
        console.error('Error creando sorteo:', error);
        showUserAlert(`‚ùå Error creando sorteo: ${error.message}`, 'error');
    }
}

// =============================================
// FUNCIONES DE CONEXI√ìN WALLET - CORREGIDAS
// =============================================

async function connectRealWallet(walletType) {
    try {
        let provider;

        if (walletType === 'phantom') {
            provider = window.solana;
        } else if (walletType === 'solflare') {
            provider = window.solflare;
        } else {
            throw new Error('Wallet no soportada');
        }

        if (!provider) {
            showUserAlert(
                `${walletType} no est√° instalada. Por favor, inst√°lala desde ${walletType === 'phantom' ? 'phantom.app' : 'solflare.com'}`,
                'warning',
                8000
            );
            return false;
        }

        const response = await provider.connect();
        const publicKey = provider.publicKey;

        const balance = await connection.getBalance(publicKey);
        const balanceInSOL = balance / solanaWeb3.LAMPORTS_PER_SOL;

        currentWallet = {
            publicKey: publicKey,
            provider: provider,
            balance: balanceInSOL
        };

        updateWalletUI(publicKey.toString(), balanceInSOL);
        checkIfAdmin(publicKey.toString());

        document.getElementById('wallet-modal').classList.remove('active');

        showUserAlert(`‚úÖ ${walletType} conectada correctamente`, 'success');

        return true;

    } catch (error) {
        console.error('Error conectando wallet:', error);
        showUserAlert(`‚ùå Error conectando wallet: ${error.message}`, 'error');
        return false;
    }
}

function updateWalletUI(publicKey, balance) {
    const shortAddress = `${publicKey.substring(0, 6)}...${publicKey.substring(publicKey.length - 4)}`;

    document.getElementById('connected-wallet-address').textContent = shortAddress;
    document.getElementById('connected-wallet-address').style.display = 'block';
    document.getElementById('wallet-balance').textContent = `${balance.toFixed(4)} SOL`;
    document.getElementById('wallet-balance').style.display = 'block';
    document.getElementById('connect-wallet-btn').innerHTML = '<span>‚úÖ Conectado</span>';
    document.getElementById('connect-wallet-btn').className = 'btn btn-success';
    document.getElementById('network-indicator').textContent = 'üü¢ Solana Testnet';
    document.getElementById('disconnect-wallet-btn').style.display = 'block';

    document.getElementById('connection-status').innerHTML = '<strong>Estado Wallet:</strong> ‚úÖ Conectada';
}

function checkIfAdmin(publicKey) {
    isAdmin = (publicKey === ADMIN_WALLET_ADDRESS);

    if (isAdmin) {
        document.getElementById('admin-menu-item').classList.add('visible');
        showUserAlert('‚úÖ Modo verificador activado', 'success');
    } else {
        document.getElementById('admin-menu-item').classList.remove('visible');
        document.getElementById('admin-panel').classList.remove('active');
    }
    
    // Re-renderizar para mostrar los botones correctos
    renderRaffles();
}

// =============================================
// FUNCIONES DE UTILIDAD
// =============================================

function showUserAlert(message, type = 'info', duration = 5000) {
    const alert = document.getElementById('user-alert');
    const alertIcon = document.getElementById('alert-icon');
    const alertMessage = document.getElementById('alert-message');

    if (!alert) {
        console.error('‚ùå No se encontr√≥ el elemento de alerta');
        return;
    }

    alert.className = `user-alert ${type}`;

    switch(type) {
        case 'success':
            alertIcon.textContent = '‚úÖ';
            break;
        case 'error':
            alertIcon.textContent = '‚ùå';
            break;
        case 'warning':
            alertIcon.textContent = '‚ö†Ô∏è';
            break;
        default:
            alertIcon.textContent = '‚ÑπÔ∏è';
    }

    alertMessage.textContent = message;
    alert.style.display = 'block';

    if (duration > 0) {
        setTimeout(() => {
            alert.style.display = 'none';
        }, duration);
    }
}

// =============================================
// CONFIGURACI√ìN DE EVENT LISTENERS GLOBALES
// =============================================

function setupGlobalEventListeners() {
    console.log('üîß Configurando event listeners globales...');
    
    // Bot√≥n de conectar wallet
    document.getElementById('connect-wallet-btn').addEventListener('click', function() {
        document.getElementById('wallet-modal').classList.add('active');
    });

    // Cerrar modal wallet
    document.getElementById('close-wallet-modal').addEventListener('click', function() {
        document.getElementById('wallet-modal').classList.remove('active');
    });

    // Conectar wallets
    document.getElementById('connect-phantom-real').addEventListener('click', function() {
        connectRealWallet('phantom');
    });

    document.getElementById('connect-solflare-real').addEventListener('click', function() {
        connectRealWallet('solflare');
    });

    // Desconectar wallet
    document.getElementById('disconnect-wallet-btn').addEventListener('click', function() {
        if (currentWallet.provider) {
            currentWallet.provider.disconnect();
        }
        currentWallet = { publicKey: null, provider: null, balance: 0 };
        isAdmin = false;
        
        document.getElementById('connected-wallet-address').style.display = 'none';
        document.getElementById('wallet-balance').style.display = 'none';
        document.getElementById('connect-wallet-btn').innerHTML = '<span>üëõ Conectar Wallet</span>';
        document.getElementById('connect-wallet-btn').className = 'btn';
        document.getElementById('network-indicator').textContent = 'üî¥ Desconectado';
        document.getElementById('disconnect-wallet-btn').style.display = 'none';
        document.getElementById('admin-menu-item').classList.remove('visible');
        
        showUserAlert('üîå Wallet desconectada', 'info');
        renderRaffles();
    });

    // Formulario de crear sorteo
    const createRaffleForm = document.getElementById('create-raffle-form');
    if (createRaffleForm) {
        createRaffleForm.addEventListener('submit', createRaffle);
    }

    // Panel admin
    document.getElementById('admin-panel-link').addEventListener('click', function(e) {
        e.preventDefault();
        if (isAdmin) {
            document.getElementById('admin-panel').classList.add('active');
            window.scrollTo({ top: document.getElementById('admin-panel').offsetTop - 100, behavior: 'smooth' });
        } else {
            showUserAlert('‚ùå Solo el verificador puede acceder al panel', 'error');
        }
    });

    document.getElementById('close-admin-panel').addEventListener('click', function() {
        document.getElementById('admin-panel').classList.remove('active');
    });

    // Cerrar alertas
    document.getElementById('close-alert').addEventListener('click', function() {
        document.getElementById('user-alert').style.display = 'none';
    });

    console.log('‚úÖ Event listeners globales configurados');
}

// =============================================
// INICIALIZACI√ìN DE LA APLICACI√ìN
// =============================================

async function initApp() {
    console.log('üöÄ Inicializando VeriRifa-Sol...');
    
    try {
        // 1. Configurar event listeners globales primero
        setupGlobalEventListeners();
        setupImagePreview();
        
        // 2. Conectar a blockchain
        await connectToBlockchain();
        
        // 3. Cargar datos de Firebase
        await loadRafflesFromFirebase();
        
        // 4. Renderizar la UI
        renderRaffles();
        
        console.log('‚úÖ VeriRifa-Sol inicializada correctamente');
        showUserAlert('‚úÖ VeriRifa-Sol cargada. Conectada a Solana Testnet + Firebase.', 'success');
        
    } catch (error) {
        console.error('‚ùå Error inicializando la aplicaci√≥n:', error);
        showUserAlert('‚ùå Error inicializando la aplicaci√≥n', 'error');
    }
}

async function connectToBlockchain() {
    try {
        document.getElementById('real-connection-status').innerHTML = '<strong>Estado Blockchain:</strong> Conectando...';

        const version = await connection.getVersion();
        const slot = await connection.getSlot();

        document.getElementById('real-connection-status').innerHTML =
            `<strong>Estado Blockchain:</strong> ‚úÖ Conectado a Solana Testnet<br>
             <small>Version: ${version['solana-core']} | Slot: ${slot.toLocaleString()}</small>`;

        console.log('‚úÖ Conectado a Solana Testnet');
        return true;
    } catch (error) {
        document.getElementById('real-connection-status').innerHTML =
            '<strong>Estado Blockchain:</strong> ‚ùå Error conectando';
        console.error('Error conectando a Solana:', error);
        return false;
    }
}

// INICIAR LA APLICACI√ìN CUANDO EL DOM EST√â LISTO
document.addEventListener('DOMContentLoaded', function() {
    console.log('üìÑ DOM cargado, iniciando aplicaci√≥n...');
    initApp();
});
</script>
</body>
</html>
