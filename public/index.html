<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>VeriRifa-Sol - Testnet</title>

  <!-- Firebase (compat) -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-analytics-compat.js"></script>

  <!-- Solana web3 -->
  <script src="https://unpkg.com/@solana/web3.js@1.75.0/lib/index.iife.js"></script>

  <link rel="stylesheet" href="estilos.css" />
</head>
<body>
  <!-- ALERT -->
  <div id="alerts" class="alerts-container"></div>

  <!-- Wallet Modal -->
  <div id="wallet-modal" class="modal hidden">
    <div class="modal-card">
      <button class="modal-close" id="close-wallet-modal">&times;</button>
      <h3>Conectar Wallet (Solana Testnet)</h3>
      <p>Conecta Phantom o Solflare. AsegÃºrate de usar <strong>Testnet</strong>.</p>
      <div style="display:flex;gap:8px;margin-top:12px;">
        <button id="connect-phantom" class="btn">ðŸ¦„ Phantom</button>
        <button id="connect-solflare" class="btn">ðŸ”† Solflare</button>
      </div>
    </div>
  </div>

  <!-- Claim Prize Modal -->
  <div id="claim-modal" class="modal hidden">
    <div class="modal-card">
      <button class="modal-close" id="close-claim-modal">&times;</button>
      <h3>Reclamar Premio</h3>
      <div id="claim-form-container">
        <p id="claim-info">Completa tus datos para reclamar el premio.</p>
        <input id="claim-name" placeholder="Nombre completo" />
        <input id="claim-email" placeholder="Email" />
        <input id="claim-phone" placeholder="TelÃ©fono" />
        <textarea id="claim-address" placeholder="DirecciÃ³n"></textarea>
        <div style="display:flex;gap:8px;margin-top:10px;">
          <button id="submit-claim" class="btn btn-success">Enviar</button>
          <button id="cancel-claim" class="btn btn-outline">Cancelar</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Number selection modal -->
  <div id="number-selection-modal" class="modal hidden">
    <div class="modal-card large">
      <button class="modal-close" id="close-number-modal">&times;</button>
      <h3 id="modal-raffle-title">Seleccionar NÃºmeros</h3>

      <div class="modal-grid">
        <div>
          <div id="numbers-pagination" class="pagination"></div>
          <div id="numbers-grid" class="numbers-grid"></div>
        </div>

        <aside class="sidebar">
          <div><strong>Precio por nÃºmero:</strong> <span id="modal-price">0 SOL</span></div>
          <div><strong>Seleccionados:</strong> <span id="selected-count">0</span></div>
          <div id="selected-list" class="selected-list"></div>
          <div style="margin-top:12px;">
            <div><strong>Total:</strong> <span id="total-payment">0 SOL</span></div>
            <div><small id="fee-estimate">ComisiÃ³n estimada incluida</small></div>
          </div>
          <div style="margin-top:12px;">
            <button id="confirm-payment-btn" class="btn btn-success">Confirmar Pago</button>
            <button id="cancel-selection-btn" class="btn btn-outline">Cancelar</button>
          </div>
        </aside>
      </div>
    </div>
  </div>

  <!-- MAIN HEADER -->
  <header class="header">
    <div class="container header-inner">
      <div class="logo">
        <div class="logo-main">VeriRifa-Sol</div>
        <div class="logo-sub">SORTEOS VERIFICADOS - TESTNET</div>
      </div>

      <div class="wallet-area">
        <div id="network-indicator" class="network">ðŸ”´ Desconectado</div>
        <div id="wallet-info" class="wallet-info">
          <span id="wallet-address" class="wallet-address"></span>
          <span id="wallet-balance" class="wallet-balance"></span>
        </div>
        <button id="open-wallet-modal-btn" class="btn">ðŸ‘› Conectar Wallet</button>
        <button id="disconnect-wallet-btn" class="btn btn-outline hidden">Desconectar</button>
      </div>
    </div>
  </header>

  <main class="container">
    <!-- Admin panel (creaciÃ³n de sorteos) -->
    <section id="admin-section" class="card hidden">
      <h2>Crear Sorteo (Solo Admin)</h2>
      <form id="create-raffle-form" class="form-grid">
        <label>
          Nombre del sorteo
          <input id="raffle-name" required />
        </label>

        <label>
          DescripciÃ³n
          <textarea id="raffle-description"></textarea>
        </label>

        <label>
          Premio (opcional)
          <input id="raffle-prize" placeholder="Ej: PlayStation 5" />
        </label>

        <label>
          Precio por nÃºmero (SOL)
          <input id="ticket-price" type="number" min="0.000001" step="0.000001" required />
        </label>

        <label>
          Cantidad total de nÃºmeros
          <input id="max-numbers" type="number" min="1" value="100" required />
        </label>

        <label>
          Imagen (URL o emoji)
          <input id="raffle-image" placeholder="https://..." />
        </label>

        <div style="grid-column: 1 / -1; display:flex;gap:8px;">
          <button type="submit" class="btn btn-warning">Crear Sorteo Verificado</button>
          <button id="admin-refresh-btn" type="button" class="btn btn-outline">Actualizar lista</button>
        </div>
      </form>
    </section>

    <!-- Sorteos -->
    <section id="raffles-section" class="card">
      <h2>Sorteos Activos</h2>
      <div id="raffles-container" class="raffles-grid">
        <!-- se llenan dinÃ¡micamente -->
      </div>
    </section>

    <!-- Ganadores -->
    <section id="winners-section" class="card">
      <h2>Archivo de Ganadores</h2>
      <div id="winners-container"></div>
    </section>
  </main>

  <footer class="footer container">
    <div>Â© VeriRifa-Sol â€¢ Testnet â€¢ Wallet verificada: <strong id="admin-wallet-display">3Yekte2UrR2rKFBfm3q6D2DyinZKN58svqJvQF87RX3o</strong></div>
  </footer>

  <!-- app -->
  <script src="script.js"></script>
</body>
</html>
